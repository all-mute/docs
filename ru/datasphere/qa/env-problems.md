---
title: "{{ ml-platform-full-name }}. Решение проблем с зависимостями"
description: "Как установить библиотеки и решить связанные с этим ошибки {{ ml-platform-full-name }}? Ответы на этот и другие вопросы в данной статье."
---

# Решение проблем с зависимостями в Yandex DataSphere

Работа с зависимостями может стать настоящим вызовом при использовании Yandex DataSphere. В большинстве случаев необходимые пакеты уже предустановлены в (образ по-умолчанию). Однако, иногда возникает необходимость установить дополнительные библиотеки или разрешить конфликты между версиями пакетов. В данном практическом руководстве мы рассмотрим основные проблемы с зависимостями и способы их решения.

{% note info %}

На этой странице вы найдете:
* причины того, почему возникают проблемы с зависимостями
* руководство по решению частых проблем
* метод решения 100% проблем - использование собственного docker-образа

{% endnote %}

{% note tip %}

Если у вас в проекте много библиотек и есть проблемы с их установкой / конфликты с предустановленными библиотеками, рекомендуется перейти сразу к последней главе, так как в Yandex Datasphere ограничено использование virtualenv & apt из консоли!

{% endnote %}


## Что такое проблемы с зависимостями

Когда два пакета требуют разные версии одной и той же библиотеки, это может привести к конфликтам. Такие конфликты затрудняют установку нужных версий и могут вызвать ошибки при выполнении кода.
Иногда нужные пакеты отсутствуют в предустановленном наборе, и их нужно добавить вручную. Это особенно актуально для специальных или менее популярных библиотек.
Некоторые пакеты зависят от системных библиотек, установка которых невозможна в Yandex DataSphere из-за ограничений на использование `sudo` и `apt`. В таких случаях приходится искать обходные пути.

Если при установке или использовании пакетов возникают ошибки, это может быть связано с зависимостями. Примеры таких ошибок включают сообщения об отсутствии модуля (ModuleNotFoundError) или несовместимости версий (VersionConflict).

Когда возникает ошибка при установке пакета, `pip` обычно выводит подробное сообщение с указанием причины. Например, если возникает конфликт версий, `pip` укажет, какой пакет и какая версия вызвали проблему. Анализируйте эти сообщения, чтобы понять корень проблемы.

## Решение проблем с зависимостями

Чтобы избежать конфликтов, можно установить **конкретную версию** пакета. Например, для установки версии 0.11.1 пакета `seaborn` используйте команду:

```bash
%pip install seaborn==0.11.1
```

Иногда обновление пакетов до последних версий помогает решить проблемы с зависимостями. Для обновления пакета используйте команду:

```bash
%pip install --upgrade <имя_пакета>
```

Если конфликтующий пакет не нужен, его можно удалить:

```bash
%pip uninstall <имя_пакета>
```

Иногда после манипуляций с пакетами проблема может решиться, если перезапустить Ядро. `Верхние вкладки jupyterlab -> Cernels -> Restart cernel`.

Указывайте минимально необходимые версии пакетов, чтобы избежать конфликтов:

```bash
%pip install <имя_пакета>>=<минимальная_версия>
```

## Работа с requirements.txt

Файл `requirements.txt` позволяет задать список всех необходимых пакетов и их версий для проекта. Это упрощает установку зависимостей на других системах. Команды, которые могут вам пригодиться:

```bash
# Устанавливает библиотеки из txt файла
%pip install -r requirements.txt

# Сохраняет библиотеки в txt файл
%pip freeze > requirements.txt
```

{% note info %}

Для переиспользования окружения на других платформах (не Yandex Datashpere) рекомендуется удалять пакеты из requirements.txt, устанавливаемые через `@`.

{% endnote %}

## Использование альтернативных источников пакетов

Если нужный пакет недоступен в PyPI, его можно установить напрямую из репозитория, например, с GitHub:

```bash
%pip install git+https://github.com/username/repository
```

Вы можете указать конкретную ветку или коммит для установки:

```bash
%pip install git+https://github.com/username/repository@branch_name
```


## Сборка собственного Docker-образа

Сборка собственного [Docker-образа](../concepts/docker.md) позволяет настроить окружение с необходимыми зависимостями и инструментами, что ускоряет настройку новых проектов и обеспечивает стабильность. Вы можете:
* использовать собственный заготовленный образ
* использовать “чистые” питон-образы без предустановленных зависимостей
* устанавливать инструменты в систему через `apt`
* использовать другие версии библиотек-драйверов: например, другую версию CUDA
* быстрее устанавливать большие библиотеки или скачивать файлы

Подробнее о сборке собственного docker-образа:
1. [{#T}](../concepts/docker.md)
2. [{#T}](../operations/user-images.md)
3. (soon) Отдельный урок в бесплатном курсе "Инженер облачных сервисов"

##  Другие часто возникающие ошибки и их решения

### Примеры распространенных ошибок и их исправление

#### Ошибка: `ModuleNotFoundError`
Эта ошибка возникает, когда пакет не установлен. Убедитесь, что пакет установлен, используя `%pip install <имя_пакета>`.

#### Ошибка: `VersionConflict`
Эта ошибка возникает, когда установлены несовместимые версии пакетов. Проверьте версии пакетов и установите совместимые версии:

```bash
%pip install <имя_пакета>==<необходимая_версия>
```

#### Ошибка: `Could not find a version that satisfies the requirement`
Эта ошибка может возникнуть, если указана неверная версия или если пакет не доступен. Проверьте правильность имени пакета и версии или попробуйте установить другую версию.

### Что можно сделать ещё
Если вы столкнулись с ошибкой, которую не можете решить, обратитесь в поддержку.